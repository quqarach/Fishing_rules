<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–†—ã–±–∞–ª–∫–∞: –º–æ–∂–Ω–æ –∏–ª–∏ –Ω–µ—Ç?</title>

  <!-- –°—Ç–∏–ª–∏ Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>

  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      height: 100%;
      overflow: hidden;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #2c3e50;
      color: white;
      padding: 10px 20px;
      text-align: center;
      font-size: 14px;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    /* –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å */
    .sidebar {
      position: fixed;
      top: 50px;
      left: 20px;
      width: 320px;
      max-height: 80vh;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
      z-index: 1000;
      overflow-y: auto;
      padding: 15px;
      font-size: 14px;
      line-height: 1.6;
    }

    .sidebar h3 {
      margin-top: 0;
      color: #2c3e50;
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
    }

    .sidebar ul {
      padding-left: 20px;
      margin: 10px 0;
    }

    .sidebar li {
      margin: 4px 0;
    }

    .sidebar table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
    }

    .sidebar th, .sidebar td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: left;
      font-size: 13px;
    }

    .sidebar th {
      background-color: #f2f2f2;
    }

    .date-picker {
      margin: 10px 0 15px 0;
    }

    .date-picker label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #2c3e50;
    }

    .date-picker input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }

    #map {
      width: 100%;
      height: 100vh;
      margin-top: 50px;
    }

    .marker-info {
      padding: 6px 8px;
      font-size: 13px;
    }
  </style>
</head>
<body>

  <!-- –®–∞–ø–∫–∞ —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å—é -->
  <div class="header">
    –î–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ü—Ä–∏–∫–∞–∑–∞ –ú–∏–Ω—Å–µ–ª—å—Ö–æ–∑–∞ –†–§ ‚Ññ1 –æ—Ç 9 —è–Ω–≤–∞—Ä—è 2020 –≥. –ê–∫—Ç—É–∞–ª—å–Ω–æ –¥–æ <strong>1 –º–∞—Ä—Ç–∞ 2026 –≥–æ–¥–∞</strong>.
  </div>

  <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
  <div class="sidebar">
    <h3>üìÖ –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h3>
    <div class="date-picker">
      <label for="fishing-date">–î–∞—Ç–∞ —Ä—ã–±–∞–ª–∫–∏:</label>
      <input type="date" id="fishing-date">
    </div>

    <h3>üìÖ –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø—Ä–µ—Ç—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É</h3>
    <ul id="active-restrictions">
      <li>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–ø—Ä–µ—Ç—ã.</li>
    </ul>

    <h3>üö´ –û–±—â–∏–µ –∑–∞–ø—Ä–µ—Ç—ã (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ)</h3>
    <ul>
      <li>–ó–∞–ø—Ä–µ—â–µ–Ω–æ –≤ –∫–∞–Ω–∞–ª–∞—Ö –ì–≠–°, —à–ª—é–∑–∞—Ö, –ø–æ–¥–≤–æ–¥—è—â–∏—Ö –∫–∞–Ω–∞–ª–∞—Ö.</li>
      <li>–ó–∞–ø—Ä–µ—â–µ–Ω–æ –≤ 500 –º –æ—Ç —É—Å—Ç—å–µ–≤ —Ä–µ–∫ –∏ –ø–ª–æ—Ç–∏–Ω.</li>
      <li>–ó–∞–ø—Ä–µ—â–µ–Ω–æ –ª–æ–≤–∏—Ç—å –æ—Å–µ—Ç—Ä–æ–≤—ã—Ö, –∫—É—Ç—É–º–∞, —à–µ–º–∞—é, —Ä–∞–∫–∞ —Å –∏–∫—Ä–æ–π.</li>
      <li>–ó–∞–ø—Ä–µ—â–µ–Ω–æ –∏–º–µ—Ç—å –ø—Ä–∏ —Å–µ–±–µ —Å–µ—Ç–∏, –Ω–µ–≤–æ–¥—ã –∏ –¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–Ω–∞—Å—Ç–∏.</li>
    </ul>

    <h3>üé£ –ù–æ—Ä–º—ã –≤—ã–ª–æ–≤–∞ (–ª—é–±–∏—Ç–µ–ª—å—Å–∫–æ–µ)</h3>
    <table>
      <tr><th>–í–∏–¥ —Ä—ã–±—ã</th><th>–ú–∏–Ω. —Ä–∞–∑–º–µ—Ä</th><th>–°—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞</th></tr>
      <tr><td>–°—É–¥–∞–∫</td><td>42 —Å–º</td><td>2 —ç–∫–∑.</td></tr>
      <tr><td>–°–æ–º</td><td>70 —Å–º</td><td>2 —ç–∫–∑.</td></tr>
      <tr><td>–°–∞–∑–∞–Ω</td><td>35 —Å–º</td><td>3 —ç–∫–∑.</td></tr>
      <tr><td>–¢–∞—Ä–∞–Ω—å</td><td>18 —Å–º</td><td>5 –∫–≥</td></tr>
      <tr><td>–©—É–∫–∞</td><td>40 —Å–º</td><td>2 —ç–∫–∑.</td></tr>
    </table>

    <h3>üé£ –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –æ—Ä—É–¥–∏—è</h3>
    <ul>
      <li>–£–¥–æ—á–∫–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ ‚Äî –Ω–µ –±–æ–ª–µ–µ 5 –∫—Ä—é—á–∫–æ–≤ –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞.</li>
      <li>–°–ø–∏–Ω–Ω–∏–Ω–≥.</li>
      <li>–†–∞–∫–æ–ª–æ–≤–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–≤–ª–∏ —Ä–∞–∫–æ–≤ –≤ –ø—Ä–µ—Å–Ω–æ–π –≤–æ–¥–µ.</li>
      <li>–ó–∞–ø—Ä–µ—â–µ–Ω–æ: —Å–µ—Ç–∏, –Ω–µ–≤–æ–¥—ã, —Ç—Ä–∞–ª–∏, —ç–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–º—ã—Å–µ–ª, –≤–∑—Ä—ã–≤—ã.</li>
    </ul>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç—ã -->
  <div id="map"></div>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>

  <script>
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const today = new Date();
    const dateString = today.toISOString().slice(0, 10);
    document.getElementById('fishing-date').value = dateString;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
    const map = L.map('map').setView([47.2313, 39.7233], 8);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    let marker = null;

    // --- –ë–∞–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–µ—Ç–æ–≤ –∏–∑ –ü—Ä–∏–∫–∞–∑–∞ ‚Ññ1 ---
    const seasonalRestrictions = [
      {
        name: "–¶–∏–º–ª—è–Ω—Å–∫–æ–µ –≤–æ–¥–æ—Ö—Ä–∞–Ω–∏–ª–∏—â–µ: –∑–∞–ø—Ä–µ—Ç –æ—Ç –ø–ª–æ—Ç–∏–Ω—ã –¥–æ —Å—Ç. –õ–æ–∂–∫–∏",
        period: { start: "05-01", end: "07-15" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä—ã–±–æ–ª–æ–≤—Å—Ç–≤–æ –æ—Ç –ø–ª–æ—Ç–∏–Ω—ã –¶–∏–º–ª—è–Ω—Å–∫–æ–π –ì–≠–° –¥–æ –∂/–¥ –º–æ—Å—Ç–∞ —É —Å—Ç. –õ–æ–∂–∫–∏."
      },
      {
        name: "–ó–∞–ø—Ä–µ—Ç–Ω—ã–µ –¥–ª—è –¥–æ–±—ã—á–∏ (–≤—ã–ª–æ–≤–∞) –≤–æ–¥–Ω—ã—Ö –±–∏–æ—Ä–µ—Å—É—Ä—Å–æ–≤ —Å—Ä–æ–∫–∏ (–ø–µ—Ä–∏–æ–¥—ã):",
        period: { start: "04-01", end: "05-31" },
        rule: "–≤ —Ä–µ–∫–µ –ê–∫—Å–∞–π —Å –≤–ø–∞–¥–∞—é—â–∏–º–∏ –≤ –Ω–µ–µ —Ä–µ–∫–∞–º–∏ –¢—É–∑–ª–æ–≤, –ì—Ä—É—à–µ–≤–∫–∞ –∏ –µ—Ä–∏–∫–æ–º –ö–∞—Ä–∞–∏—á, —Ä–µ–∫–æ–π –ß–µ—Ä–∫–∞—Å—Å–∫–æ–π —Å –ú–∞—Ö–∏–Ω—Å–∫–∏–º –ª–∏–º–∞–Ω–æ–º, —Ä–µ–∫–µ –ö–æ–π—Å—É–≥;"
      },
      {
        name: "–†–∞–∫ –ø—Ä–µ—Å–Ω–æ–≤–æ–¥–Ω—ã–π (–†–æ—Å—Ç–æ–≤—Å–∫–∞—è, –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π, –ö—Ä—ã–º)",
        period: { start: "01-01", end: "06-14" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–∞ –ª–æ–≤–ª—è —Ä–∞–∫–∞ —Ä–∞–∫–æ–ª–æ–≤–∫–∞–º–∏."
      },
      {
        name: "–†–∞–∫ –ø—Ä–µ—Å–Ω–æ–≤–æ–¥–Ω—ã–π (–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π, –ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å–∏—è)",
        period: { start: "08-16", end: "11-30" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–∞ –ª–æ–≤–ª—è —Ä–∞–∫–∞ —Ä–∞–∫–æ–ª–æ–≤–∫–∞–º–∏."
      },
      {
        name: "–ó–∏–º–æ–≤–∞–ª—å–Ω—ã–µ —è–º—ã (–≤—Å–µ)",
        period: { start: "11-15", end: "03-31" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä—ã–±–æ–ª–æ–≤—Å—Ç–≤–æ –≤ –∑–∏–º–æ–≤–∞–ª—å–Ω—ã—Ö —è–º–∞—Ö."
      },
      {
        name: "–†–µ–∫–∏ –î–ù–†, –ó–∞–ø–æ—Ä–æ–∂—Å–∫–æ–π –∏ –•–µ—Ä—Å–æ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–µ–π",
        period: { start: "04-01", end: "05-31" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä—ã–±–æ–ª–æ–≤—Å—Ç–≤–æ –≤–æ –≤—Å–µ—Ö —Ä–µ–∫–∞—Ö –∏ –ø–æ–π–º–µ–Ω–Ω—ã—Ö –≤–æ–¥–æ—ë–º–∞—Ö."
      },
      {
        name: "–û–∑–µ—Ä–æ –î–æ–Ω—É–∑–ª–∞–≤ (–ö—Ä—ã–º)",
        period: { start: "06-01", end: "08-31" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä—ã–±–æ–ª–æ–≤—Å—Ç–≤–æ –≤ 500 –º –æ—Ç –≥–∏—Ä–ª–∞ –æ–∑–µ—Ä–∞."
      },
      {
        name: "–†–µ–∫–∞ –î–æ–Ω: –æ—Ç —Å—Ç. –õ–æ–∂–∫–∏ –¥–æ —É—Å—Ç—å—è –ò–ª–æ–≤–ª–∏",
        period: { start: "04-25", end: "06-01" },
        rule: "–ó–∞–ø—Ä–µ—â–µ–Ω–æ —Ä—ã–±–æ–ª–æ–≤—Å—Ç–≤–æ (–∫—Ä–æ–º–µ –æ–¥–Ω–æ–π —É–¥–æ—á–∫–∏ —Å 1 –∫—Ä—é—á–∫–æ–º —Å –±–µ—Ä–µ–≥–∞)."
      }
    ];

    // --- –§—É–Ω–∫—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø–æ–ø–∞–¥–∞–µ—Ç –ª–∏ –¥–∞—Ç–∞ –≤ –ø–µ—Ä–∏–æ–¥ ---
    function isDateInPeriod(date, startMMDD, endMMDD) {
      const monthDay = date.toISOString().slice(5, 10); // "MM-DD"
      const year = date.getFullYear();

      const start = new Date(`${year}-${startMMDD}`);
      const end = new Date(`${year}-${endMMDD}`);
      if (end < start) end.setFullYear(year + 1); // –µ—Å–ª–∏ –ø–µ—Ä–∏–æ–¥ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –≥–æ–¥

      const target = new Date(date);
      target.setHours(0, 0, 0, 0);

      if (end > start) {
        return target >= start && target <= end;
      } else {
        return target >= start || target <= end;
      }
    }

    // --- –§—É–Ω–∫—Ü–∏—è: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–µ—Ç–æ–≤ ---
    function updateRestrictions(date) {
      const list = document.getElementById('active-restrictions');
      list.innerHTML = '';

      const active = seasonalRestrictions.filter(item => {
        return isDateInPeriod(date, item.period.start, item.period.end);
      });

      if (active.length === 0) {
        list.innerHTML = '<li>–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–µ—Ç–æ–≤.</li>';
      } else {
        active.forEach(item => {
          const li = document.createElement('li');
          li.innerHTML = `<strong>${item.name}:</strong> ${item.rule}`;
          list.appendChild(li);
        });
      }
    }

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞—Ç—ã ---
    document.getElementById('fishing-date').addEventListener('change', function() {
      const selectedDateStr = this.value;
      const selectedDate = new Date(selectedDateStr);
      updateRestrictions(selectedDate);
    });

    // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–µ ---
    map.on('click', function(e) {
      const lat = e.latlng.lat;
      const lng = e.latlng.lng;
      const selectedDateStr = document.getElementById('fishing-date').value;
      const selectedDate = new Date(selectedDateStr);

      if (marker) map.removeLayer(marker);
      marker = L.marker([lat, lng]).addTo(map);

      marker.bindPopup(`
        <div class="marker-info">
          <strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong><br>
          –®–∏—Ä–æ—Ç–∞: ${lat.toFixed(6)}<br>
          –î–æ–ª–≥–æ—Ç–∞: ${lng.toFixed(6)}<br>
          <strong>–î–∞—Ç–∞:</strong> ${selectedDateStr}<br>
          <em>–ú–æ–∂–Ω–æ –ª–∏ –ª–æ–≤–∏—Ç—å ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–æ–Ω—ã –∏ –¥–∞—Ç—ã.</em>
        </div>
      `).openPopup();

      console.log(`–ú–µ—Ç–∫–∞: ${lat.toFixed(6)}, ${lng.toFixed(6)} | –î–∞—Ç–∞: ${selectedDateStr}`);
    });

    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø—Ä–µ—Ç—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è ---
    updateRestrictions(today);
  </script>
</body>
</html>